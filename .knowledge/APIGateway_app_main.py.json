{"is_source_file": true, "format": "Python", "description": "This file is a FastAPI application serving as an API Gateway for an e-commerce system. It provides endpoints for health checks, product pricing, notifications, analytics, and WebSocket usage notes. It includes configuration loading, middleware setup, data models, and proxy methods that call other microservices.", "external_files": ["httpx", "fastapi", "pydantic", "os", "typing"], "external_methods": ["httpx.AsyncClient", "fastapi.FastAPI", "fastapi.HTTPException", "fastapi.Depends", "fastapi.Header", "fastapi.Query", "fastapi.middleware.cors.CORSMiddleware", "pydantic.BaseModel", "pydantic.Field"], "published": ["get_settings", "health", "websocket_help", "composed_price", "proxy_send_notification", "proxy_sales_summary"], "classes": [{"name": "ProductPriceQuery", "description": "Model defining parameters for querying product price."}, {"name": "SendNotification", "description": "Model defining email notification details."}], "methods": [{"name": "Dict[str,Any] get_settings()", "description": "Retrieves configuration settings from environment variables.", "scope": "", "scopeKind": ""}, {"name": "health()", "description": "Returns liveness status of the service.", "scope": "", "scopeKind": ""}, {"name": "websocket_help()", "description": "Provides help information about WebSocket endpoints (not implemented).", "scope": "", "scopeKind": ""}, {"name": "composed_price(payload: ProductPriceQuery, _: bool = Depends(require_api_key))", "description": "Proxies request to fetch product price from Price service.", "scope": "", "scopeKind": ""}, {"name": "proxy_send_notification(body: SendNotification, _: bool = Depends(require_api_key))", "description": "Proxies request to Notification service to send an email.", "scope": "", "scopeKind": ""}, {"name": "proxy_sales_summary(range: str = Query(\"7d\", description=\"Time range like '24h', '7d', '30d'\"), _: bool = Depends(require_api_key))", "description": "Proxies request to Analytics service for sales summary data.", "scope": "", "scopeKind": ""}, {"name": "require_api_key(x_api_key: Optional[str] = Header(default=None))", "scope": "", "scopeKind": "", "description": "unavailable"}], "calls": ["httpx.AsyncClient", "client.post", "client.get"], "search-terms": ["API Gateway", "price query", "notifications", "analytics proxy", "FastAPI middleware"], "state": 2, "file_id": 2, "knowledge_revision": 5, "git_revision": "", "ctags": [{"_type": "tag", "name": "ProductPriceQuery", "path": "/home/kavia/workspace/code-generation/e-commerce-store-11176-11412/APIGateway/app/main.py", "pattern": "/^class ProductPriceQuery(BaseModel):$/", "language": "Python", "kind": "class"}, {"_type": "tag", "name": "SendNotification", "path": "/home/kavia/workspace/code-generation/e-commerce-store-11176-11412/APIGateway/app/main.py", "pattern": "/^class SendNotification(BaseModel):$/", "language": "Python", "kind": "class"}, {"_type": "tag", "name": "allow_origins", "path": "/home/kavia/workspace/code-generation/e-commerce-store-11176-11412/APIGateway/app/main.py", "pattern": "/^allow_origins = [o.strip() for o in settings[\"ALLOWED_ORIGINS\"].split(\",\")] if settings[\"ALLOWED/", "language": "Python", "kind": "variable"}, {"_type": "tag", "name": "app", "path": "/home/kavia/workspace/code-generation/e-commerce-store-11176-11412/APIGateway/app/main.py", "pattern": "/^app = FastAPI($/", "language": "Python", "kind": "variable"}, {"_type": "tag", "name": "body", "path": "/home/kavia/workspace/code-generation/e-commerce-store-11176-11412/APIGateway/app/main.py", "pattern": "/^    body: str = Field(..., description=\"Email plaintext body\")$/", "language": "Python", "typeref": "typename:str", "kind": "variable", "scope": "SendNotification", "scopeKind": "class"}, {"_type": "tag", "name": "composed_price", "path": "/home/kavia/workspace/code-generation/e-commerce-store-11176-11412/APIGateway/app/main.py", "pattern": "/^async def composed_price(payload: ProductPriceQuery, _: bool = Depends(require_api_key)):$/", "language": "Python", "kind": "function", "signature": "(payload: ProductPriceQuery, _: bool = Depends(require_api_key))"}, {"_type": "tag", "name": "currency", "path": "/home/kavia/workspace/code-generation/e-commerce-store-11176-11412/APIGateway/app/main.py", "pattern": "/^    currency: str = Field(..., description=\"ISO Currency code, e.g., USD\")$/", "language": "Python", "typeref": "typename:str", "kind": "variable", "scope": "ProductPriceQuery", "scopeKind": "class"}, {"_type": "tag", "name": "get_settings", "path": "/home/kavia/workspace/code-generation/e-commerce-store-11176-11412/APIGateway/app/main.py", "pattern": "/^def get_settings() -> Dict[str, Any]:$/", "language": "Python", "typeref": "typename:Dict[str,Any]", "kind": "function", "signature": "()"}, {"_type": "tag", "name": "health", "path": "/home/kavia/workspace/code-generation/e-commerce-store-11176-11412/APIGateway/app/main.py", "pattern": "/^async def health():$/", "language": "Python", "kind": "function", "signature": "()"}, {"_type": "tag", "name": "include_promotions", "path": "/home/kavia/workspace/code-generation/e-commerce-store-11176-11412/APIGateway/app/main.py", "pattern": "/^    include_promotions: bool = Field(True, description=\"Whether to apply active promotions\")$/", "language": "Python", "typeref": "typename:bool", "kind": "variable", "scope": "ProductPriceQuery", "scopeKind": "class"}, {"_type": "tag", "name": "product_id", "path": "/home/kavia/workspace/code-generation/e-commerce-store-11176-11412/APIGateway/app/main.py", "pattern": "/^    product_id: str = Field(..., description=\"Unique product identifier\")$/", "language": "Python", "typeref": "typename:str", "kind": "variable", "scope": "ProductPriceQuery", "scopeKind": "class"}, {"_type": "tag", "name": "proxy_sales_summary", "path": "/home/kavia/workspace/code-generation/e-commerce-store-11176-11412/APIGateway/app/main.py", "pattern": "/^async def proxy_sales_summary(range: str = Query(\"7d\", description=\"Time range like '24h', '7d',/", "language": "Python", "kind": "function", "signature": "(range: str = Query(\"7d\", description=\"Time range like '24h', '7d', '30d'\"), _: bool = Depends(require_api_key))"}, {"_type": "tag", "name": "proxy_send_notification", "path": "/home/kavia/workspace/code-generation/e-commerce-store-11176-11412/APIGateway/app/main.py", "pattern": "/^async def proxy_send_notification(body: SendNotification, _: bool = Depends(require_api_key)):$/", "language": "Python", "kind": "function", "signature": "(body: SendNotification, _: bool = Depends(require_api_key))"}, {"_type": "tag", "name": "require_api_key", "path": "/home/kavia/workspace/code-generation/e-commerce-store-11176-11412/APIGateway/app/main.py", "pattern": "/^async def require_api_key(x_api_key: Optional[str] = Header(default=None)):$/", "language": "Python", "kind": "function", "signature": "(x_api_key: Optional[str] = Header(default=None))"}, {"_type": "tag", "name": "settings", "path": "/home/kavia/workspace/code-generation/e-commerce-store-11176-11412/APIGateway/app/main.py", "pattern": "/^settings = get_settings()$/", "language": "Python", "kind": "variable"}, {"_type": "tag", "name": "subject", "path": "/home/kavia/workspace/code-generation/e-commerce-store-11176-11412/APIGateway/app/main.py", "pattern": "/^    subject: str = Field(..., description=\"Email subject\")$/", "language": "Python", "typeref": "typename:str", "kind": "variable", "scope": "SendNotification", "scopeKind": "class"}, {"_type": "tag", "name": "template_id", "path": "/home/kavia/workspace/code-generation/e-commerce-store-11176-11412/APIGateway/app/main.py", "pattern": "/^    template_id: Optional[str] = Field(None, description=\"Optional template id for provider\")$/", "language": "Python", "typeref": "typename:Optional[str]", "kind": "variable", "scope": "SendNotification", "scopeKind": "class"}, {"_type": "tag", "name": "to_email", "path": "/home/kavia/workspace/code-generation/e-commerce-store-11176-11412/APIGateway/app/main.py", "pattern": "/^    to_email: str = Field(..., description=\"Recipient email address\")$/", "language": "Python", "typeref": "typename:str", "kind": "variable", "scope": "SendNotification", "scopeKind": "class"}, {"_type": "tag", "name": "websocket_help", "path": "/home/kavia/workspace/code-generation/e-commerce-store-11176-11412/APIGateway/app/main.py", "pattern": "/^async def websocket_help():$/", "language": "Python", "kind": "function", "signature": "()"}], "hash": "efbd45419823782c9e7d2d42d09f2d5b", "format-version": 4, "code-base-name": "APIGateway", "filename": "APIGateway/app/main.py", "fields": [{"name": "allow_origins = [o.strip() for o in settings[\"ALLOWED_ORIGINS\"].split(\",\")] if settings[\"ALLOWED/", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "app = FastAPI(", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "str body", "scope": "SendNotification", "scopeKind": "class", "description": "unavailable"}, {"name": "str currency", "scope": "ProductPriceQuery", "scopeKind": "class", "description": "unavailable"}, {"name": "bool include_promotions", "scope": "ProductPriceQuery", "scopeKind": "class", "description": "unavailable"}, {"name": "str product_id", "scope": "ProductPriceQuery", "scopeKind": "class", "description": "unavailable"}, {"name": "settings = get_settings()", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "str subject", "scope": "SendNotification", "scopeKind": "class", "description": "unavailable"}, {"name": "Optional[str] template_id", "scope": "SendNotification", "scopeKind": "class", "description": "unavailable"}, {"name": "str to_email", "scope": "SendNotification", "scopeKind": "class", "description": "unavailable"}], "revision_history": [{"5": ""}]}